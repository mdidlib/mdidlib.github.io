<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital Footprint - MDID Digital Skills</title>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fadeIn {
            animation: fadeIn 0.5s ease-out;
        }
        @keyframes slideIn {
            from { transform: translateX(-20px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        .animate-slideIn {
            animation: slideIn 0.3s ease-out;
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        .animate-pulse-subtle {
            animation: pulse 2s ease-in-out infinite;
        }
        @keyframes footprint {
            0% { opacity: 0; transform: translateY(-10px) scale(0.8); }
            50% { opacity: 1; transform: translateY(0) scale(1); }
            100% { opacity: 0.3; transform: translateY(10px) scale(0.9); }
        }
        .animate-footprint {
            animation: footprint 2s ease-in-out infinite;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef, useEffect } = React;

        console.log("Digital Footprint module starting...");

        // Icon components
        const Footprints = ({ className }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M4 16v-2.38C4 11.5 2.97 10.5 3 8c.03-2.72 1.49-6 4.5-6C9.37 2 10 3.8 10 5.5c0 3.11-2 5.66-2 8.68V16a2 2 0 1 1-4 0Z"/>
                <path d="M20 20v-2.38c0-2.12 1.03-3.12 1-5.62-.03-2.72-1.49-6-4.5-6C14.63 6 14 7.8 14 9.5c0 3.11 2 5.66 2 8.68V20a2 2 0 1 0 4 0Z"/>
                <path d="M16 17h4"/>
                <path d="M4 13h4"/>
            </svg>
        );

        const Globe = ({ className }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="12" cy="12" r="10"/>
                <line x1="2" x2="22" y1="12" y2="12"/>
                <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
            </svg>
        );

        const Eye = ({ className }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/>
                <circle cx="12" cy="12" r="3"/>
            </svg>
        );

        const Clock = ({ className }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="12" cy="12" r="10"/>
                <polyline points="12 6 12 12 16 14"/>
            </svg>
        );

        const CheckCircle = ({ className }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                <polyline points="22 4 12 14.01 9 11.01"/>
            </svg>
        );

        const XCircle = ({ className }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="12" cy="12" r="10"/>
                <path d="m15 9-6 6"/>
                <path d="m9 9 6 6"/>
            </svg>
        );

        const Lightbulb = ({ className }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5"/>
                <path d="M9 18h6"/>
                <path d="M10 22h4"/>
            </svg>
        );

        const RefreshCw = ({ className }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/>
                <path d="M21 3v5h-5"/>
                <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/>
                <path d="M8 16H3v5"/>
            </svg>
        );

        const Share = ({ className }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="18" cy="5" r="3"/>
                <circle cx="6" cy="12" r="3"/>
                <circle cx="18" cy="19" r="3"/>
                <line x1="8.59" x2="15.42" y1="13.51" y2="17.49"/>
                <line x1="15.41" x2="8.59" y1="6.51" y2="10.49"/>
            </svg>
        );

        const AlertTriangle = ({ className }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/>
                <line x1="12" x2="12" y1="9" y2="13"/>
                <line x1="12" x2="12.01" y1="17" y2="17"/>
            </svg>
        );

        const DigitalFootprintModule = () => {
            const [currentScreen, setCurrentScreen] = useState('welcome');
            const [currentRound, setCurrentRound] = useState('warmup');
            const [currentChallenge, setCurrentChallenge] = useState(0);
            const [score, setScore] = useState(0);
            const [showFeedback, setShowFeedback] = useState(false);
            const [isCorrect, setIsCorrect] = useState(false);
            const [showHint, setShowHint] = useState(false);
            const [selectedAnswer, setSelectedAnswer] = useState(null);
            const [selectedItems, setSelectedItems] = useState([]);
            const [userInput, setUserInput] = useState('');
            const inputRef = useRef(null);

            console.log("Module initialized, current screen:", currentScreen, "round:", currentRound);

            // Warm-up: Understanding Digital Footprints
            const warmupChallenges = [
                {
                    id: 1,
                    title: "What Creates a Footprint?",
                    question: "Which of these activities leave a digital footprint? Select ALL that apply.",
                    type: "multiselect",
                    options: [
                        { id: 'a', text: "Posting a photo on Instagram", leavesFootprint: true },
                        { id: 'b', text: "Liking a friend's TikTok video", leavesFootprint: true },
                        { id: 'c', text: "Reading a book at home", leavesFootprint: false },
                        { id: 'd', text: "Searching on Google", leavesFootprint: true },
                        { id: 'e', text: "Signing up for a website", leavesFootprint: true },
                        { id: 'f', text: "Writing in a paper journal", leavesFootprint: false }
                    ],
                    explanation: "Most online activities create a digital footprint! Posting, liking, searching, and signing up all leave traces. Only offline activities like reading physical books or writing in paper journals don't create digital records.",
                    hint: "Think about what requires the internet vs. what doesn't."
                },
                {
                    id: 2,
                    title: "Active vs. Passive Footprints",
                    question: "A PASSIVE digital footprint is data collected WITHOUT your direct action. Which is a PASSIVE footprint?",
                    type: "single",
                    options: [
                        { id: 'a', text: "Posting a status update", correct: false },
                        { id: 'b', text: "A website tracking your browsing with cookies", correct: true },
                        { id: 'c', text: "Sending a DM to a friend", correct: false },
                        { id: 'd', text: "Creating a YouTube video", correct: false }
                    ],
                    explanation: "Passive footprints are created automatically without you doing anything intentional - like cookies tracking which sites you visit, your location being logged, or apps collecting data in the background. Active footprints are things YOU create: posts, comments, messages.",
                    hint: "Which option happens even when you're not actively doing something?"
                },
                {
                    id: 3,
                    title: "The Internet Never Forgets",
                    question: "You post something embarrassing, then delete it 5 minutes later. What's TRUE about that post?",
                    type: "single",
                    options: [
                        { id: 'a', text: "It's completely gone forever", correct: false },
                        { id: 'b', text: "Someone might have screenshotted it before deletion", correct: true },
                        { id: 'c', text: "Only you can see it now", correct: false },
                        { id: 'd', text: "It automatically disappears from everyone's memory", correct: false }
                    ],
                    explanation: "Even deleted content can live on! Screenshots, cached pages, and internet archives can preserve content you thought was gone. The 'Internet Archive' has billions of saved web pages. This is why it's important to think BEFORE you post!",
                    hint: "Think about what others might do in those 5 minutes..."
                }
            ];

            // Round 1: Scenario Decisions
            const scenarioChallenges = [
                {
                    id: 1,
                    title: "The Party Photo",
                    scenario: "Your friend posts a group photo from a party where you look really bad. They tag you in it. Several people have already seen it.",
                    question: "What's the BEST first step to handle this?",
                    type: "single",
                    options: [
                        { id: 'a', text: "Post an angry comment calling them out publicly", correct: false, feedback: "This could escalate the situation and add more negative content to YOUR digital footprint." },
                        { id: 'b', text: "Privately ask your friend to remove or untag you", correct: true, feedback: "Great choice! A private, polite request is the best first step. Most friends will understand and remove it." },
                        { id: 'c', text: "Report the photo as inappropriate to get it removed", correct: false, feedback: "Unless the photo actually violates platform rules, false reporting can backfire and damage trust." },
                        { id: 'd', text: "Post unflattering photos of them in revenge", correct: false, feedback: "This only creates more problems and hurts YOUR reputation too!" }
                    ],
                    points: 25,
                    hint: "Think about solving the problem without creating a bigger one."
                },
                {
                    id: 2,
                    title: "The Job Application",
                    scenario: "You're applying for a summer job. The application asks for your social media handles. Your accounts have some posts from when you were younger that you're not proud of.",
                    question: "What should you do?",
                    type: "single",
                    options: [
                        { id: 'a', text: "Lie and say you don't have social media", correct: false, feedback: "Lying on applications can disqualify you if discovered. Employers often search anyway!" },
                        { id: 'b', text: "Do nothing - they probably won't look anyway", correct: false, feedback: "Many employers DO check social media. Being unprepared is risky." },
                        { id: 'c', text: "Review and clean up your accounts before submitting", correct: true, feedback: "Smart move! Cleaning up old posts and checking privacy settings shows maturity and awareness." },
                        { id: 'd', text: "Delete all your accounts completely", correct: false, feedback: "Having NO online presence can also seem suspicious. A clean, professional presence is better." }
                    ],
                    points: 25,
                    hint: "What would make the best impression while being honest?"
                },
                {
                    id: 3,
                    title: "The Viral Moment",
                    scenario: "Someone at school secretly records you having an embarrassing moment and posts it. It starts getting shared around.",
                    question: "What's the MOST effective response?",
                    type: "single",
                    options: [
                        { id: 'a', text: "Make more videos explaining/defending yourself", correct: false, feedback: "This often draws MORE attention to the original video and keeps it trending." },
                        { id: 'b', text: "Talk to a trusted adult and report the video to the platform", correct: true, feedback: "Yes! Unauthorized recordings (especially of minors) often violate platform policies. Adults can help navigate this properly." },
                        { id: 'c', text: "Track down everyone who shared it and demand they delete", correct: false, feedback: "Once something spreads, this approach is usually impossible and exhausting." },
                        { id: 'd', text: "Post mean things about the person who recorded you", correct: false, feedback: "This makes you look bad too and could get YOU in trouble." }
                    ],
                    points: 25,
                    hint: "Who has the power to actually help, and what rules might protect you?"
                },
                {
                    id: 4,
                    title: "The College Application",
                    scenario: "You're writing about your volunteer work for a college essay. You have great photos from the events that would look impressive.",
                    question: "What should you consider BEFORE using these photos?",
                    type: "single",
                    options: [
                        { id: 'a', text: "Just use them - you were there, so it's fine", correct: false, feedback: "Other people in photos have privacy rights too!" },
                        { id: 'b', text: "Only use photos where you're alone", correct: false, feedback: "This limits your options. There's a better approach." },
                        { id: 'c', text: "Get permission from anyone recognizable in the photos", correct: true, feedback: "Excellent! Respecting others' digital footprints shows maturity and ethical awareness - exactly what colleges want to see!" },
                        { id: 'd', text: "Use face-blurring apps on everyone else", correct: false, feedback: "This could look strange and might not fully protect privacy anyway." }
                    ],
                    points: 25,
                    hint: "Think about other people's rights and how this reflects on your character."
                }
            ];

            // Round 2: Footprint Audit
            const auditChallenges = [
                {
                    id: 1,
                    title: "Profile Review",
                    scenario: "Look at this social media profile and identify the RISKY information that shouldn't be shared publicly:",
                    profile: {
                        username: "@SoccerStar2009",
                        bio: "Lincoln High School Class of 2027 ‚öΩ | 123 Maple Street, Anytown | DMs open!",
                        posts: [
                            "Just got my driver's permit! Here's my birthday selfie (May 15!) üéÇ",
                            "Mom's at work until 6pm... party at my house? üéâ",
                            "Can't wait for vacation! We leave Friday and won't be back for 2 weeks üèñÔ∏è"
                        ]
                    },
                    type: "multiselect",
                    options: [
                        { id: 'a', text: "Birth year in username (2009)", risky: true },
                        { id: 'b', text: "School name", risky: true },
                        { id: 'c', text: "Home address", risky: true },
                        { id: 'd', text: "Sports emoji", risky: false },
                        { id: 'e', text: "Exact birthday date", risky: true },
                        { id: 'f', text: "When home is empty", risky: true },
                        { id: 'g', text: "Vacation dates (house empty)", risky: true },
                        { id: 'h', text: "Having a permit", risky: false }
                    ],
                    explanation: "This profile reveals: exact age, school, home address, birthday, when parents aren't home, and when the house will be empty for vacation. These details together could help someone find or target this person. Only the emoji and permit mention are safe to share!",
                    points: 50,
                    hint: "Think: Could someone use this info to find where I live, when I'm alone, or steal my identity?"
                },
                {
                    id: 2,
                    title: "The Time Machine Test",
                    scenario: "Imagine these posts being seen by: your future college admissions officer, your grandma, your future boss, or someone you don't know. Rate each post.",
                    type: "rating",
                    posts: [
                        { 
                            id: 1, 
                            text: "Just finished my community service hours! Planted 50 trees today üå≥",
                            rating: "positive",
                            feedback: "Great! Shows responsibility and community involvement."
                        },
                        { 
                            id: 2, 
                            text: "lol my teacher is SO stupid, worst class ever üôÑ",
                            rating: "negative",
                            feedback: "Risky! Employers and colleges don't want to see you disrespecting authority figures."
                        },
                        { 
                            id: 3, 
                            text: "Proud of my team for winning the debate tournament! üèÜ",
                            rating: "positive",
                            feedback: "Perfect! Highlights achievements and teamwork."
                        },
                        { 
                            id: 4, 
                            text: "this party is crazy lol üç∫ don't tell my parents",
                            rating: "negative",
                            feedback: "Major red flag! Evidence of rule-breaking AND deception - could affect scholarships, jobs, and more."
                        },
                        { 
                            id: 5, 
                            text: "Working on my art portfolio - here's my latest painting!",
                            rating: "positive",
                            feedback: "Excellent! Shows creativity, dedication, and appropriate sharing."
                        }
                    ],
                    points: 50,
                    hint: "Would you be comfortable with ANYONE seeing this 10 years from now?"
                }
            ];

            // Round 3: Build Your Best Footprint
            const buildChallenges = [
                {
                    id: 1,
                    title: "Rewrite for Success",
                    scenario: "Transform this risky bio into a safe, impressive one:",
                    originalBio: "James | 15 | Lincoln High | üìç Downtown Chicago | snap: james_real123 | always bored in class lol",
                    type: "rewrite",
                    goodElements: [
                        "Remove exact age",
                        "Remove specific location",
                        "Remove other platform handles",
                        "Replace negative attitude",
                        "Add positive interests/accomplishments"
                    ],
                    exampleRewrite: "James | Student & Soccer Player ‚öΩ | Love photography and gaming üì∏üéÆ | Building cool stuff one project at a time",
                    points: 50,
                    hint: "What would you want a college or employer to see? What should strangers NOT know?"
                },
                {
                    id: 2,
                    title: "Post Transformation",
                    scenario: "You want to share that you're excited about summer break. Rewrite this post to be safer:",
                    originalPost: "FINALLY summer break!! Going to Hawaii June 15-30! House will be empty, dog is at the kennel, let's goooo üå¥‚úàÔ∏è",
                    type: "rewrite",
                    goodElements: [
                        "Don't share exact travel dates",
                        "Don't announce empty house",
                        "Share excitement without security risks",
                        "Post vacation pics AFTER you return"
                    ],
                    exampleRewrite: "Summer break mode activated! Can't wait for some beach time üå¥‚òÄÔ∏è (Will share pics when I'm back!)",
                    points: 50,
                    hint: "How can you share your excitement without telling everyone your house is empty?"
                }
            ];

            const challenges = [
                { id: 1, name: "Digital Footprint Basics", icon: "üë£", description: "Learn what creates a footprint" },
                { id: 2, name: "Smart Decisions", icon: "üéØ", description: "Handle tricky situations" },
                { id: 3, name: "Footprint Audit", icon: "üîç", description: "Spot risky information" },
                { id: 4, name: "Build Your Best", icon: "‚≠ê", description: "Create a positive presence" }
            ];

            const handleMultiSelect = (optionId) => {
                if (selectedItems.includes(optionId)) {
                    setSelectedItems(selectedItems.filter(id => id !== optionId));
                } else {
                    setSelectedItems([...selectedItems, optionId]);
                }
            };

            const checkWarmupAnswer = () => {
                const challenge = warmupChallenges[currentChallenge];
                let correct = false;
                
                if (challenge.type === 'multiselect') {
                    const correctIds = challenge.options.filter(o => o.leavesFootprint).map(o => o.id);
                    correct = correctIds.length === selectedItems.length && 
                              correctIds.every(id => selectedItems.includes(id));
                } else {
                    const correctOption = challenge.options.find(o => o.correct);
                    correct = selectedAnswer === correctOption.id;
                }
                
                if (correct) {
                    setScore(score + 20);
                }
                setIsCorrect(correct);
                setShowFeedback(true);
            };

            const checkScenarioAnswer = () => {
                const challenge = scenarioChallenges[currentChallenge];
                const selectedOption = challenge.options.find(o => o.id === selectedAnswer);
                const correct = selectedOption?.correct;
                
                if (correct) {
                    setScore(score + challenge.points);
                }
                setIsCorrect(correct);
                setShowFeedback(true);
            };

            const checkAuditAnswer = () => {
                const challenge = auditChallenges[currentChallenge];
                let correct = false;
                let partialScore = 0;
                
                if (challenge.type === 'multiselect') {
                    const riskyIds = challenge.options.filter(o => o.risky).map(o => o.id);
                    const correctSelections = selectedItems.filter(id => riskyIds.includes(id)).length;
                    const incorrectSelections = selectedItems.filter(id => !riskyIds.includes(id)).length;
                    partialScore = Math.max(0, (correctSelections - incorrectSelections) / riskyIds.length * challenge.points);
                    correct = riskyIds.length === selectedItems.length && 
                              riskyIds.every(id => selectedItems.includes(id));
                } else if (challenge.type === 'rating') {
                    // For rating challenges, check selectedItems format: [{id, rating}, ...]
                    const correctRatings = challenge.posts.filter(post => {
                        const userRating = selectedItems.find(item => item.id === post.id);
                        return userRating && userRating.rating === post.rating;
                    }).length;
                    partialScore = (correctRatings / challenge.posts.length) * challenge.points;
                    correct = correctRatings === challenge.posts.length;
                }
                
                setScore(score + Math.round(partialScore));
                setIsCorrect(correct);
                setShowFeedback(true);
            };

            const nextChallenge = () => {
                setShowFeedback(false);
                setShowHint(false);
                setSelectedAnswer(null);
                setSelectedItems([]);
                setUserInput('');
                
                if (currentRound === 'warmup') {
                    if (currentChallenge < warmupChallenges.length - 1) {
                        setCurrentChallenge(currentChallenge + 1);
                    } else {
                        setCurrentRound('scenarios');
                        setCurrentChallenge(0);
                    }
                } else if (currentRound === 'scenarios') {
                    if (currentChallenge < scenarioChallenges.length - 1) {
                        setCurrentChallenge(currentChallenge + 1);
                    } else {
                        setCurrentRound('audit');
                        setCurrentChallenge(0);
                    }
                } else if (currentRound === 'audit') {
                    if (currentChallenge < auditChallenges.length - 1) {
                        setCurrentChallenge(currentChallenge + 1);
                    } else {
                        setCurrentRound('build');
                        setCurrentChallenge(0);
                    }
                } else if (currentRound === 'build') {
                    if (currentChallenge < buildChallenges.length - 1) {
                        setCurrentChallenge(currentChallenge + 1);
                    } else {
                        setCurrentScreen('completion');
                    }
                }
            };

            const handleRatingSelect = (postId, rating) => {
                const existing = selectedItems.filter(item => item.id !== postId);
                setSelectedItems([...existing, { id: postId, rating }]);
            };

            const submitBuildChallenge = () => {
                const challenge = buildChallenges[currentChallenge];
                const userInputLower = userInput.toLowerCase().trim();
                const originalLower = (challenge.originalBio || challenge.originalPost || '').toLowerCase();
                const exampleLower = challenge.exampleRewrite.toLowerCase();
                
                // Check if user just copied the example
                const exampleSimilarity = calculateSimilarity(userInputLower, exampleLower);
                if (exampleSimilarity > 0.7) {
                    // User copied the example - don't award full points
                    setScore(score + 10); // Minimal points for copying
                    setIsCorrect(false);
                    setShowFeedback(true);
                    return;
                }
                
                // Check if user just slightly modified original
                const originalSimilarity = calculateSimilarity(userInputLower, originalLower);
                if (originalSimilarity > 0.6) {
                    setIsCorrect(false);
                    setShowFeedback(true);
                    return;
                }
                
                // Simple check - if they wrote something substantial
                if (userInput.length > 20) {
                    // Check for good elements (simplified)
                    let goodPoints = 0;
                    if (!userInput.match(/\d{2,}/)) goodPoints += 10; // No specific numbers like age
                    if (!userInputLower.includes('address') && !userInputLower.includes('street')) goodPoints += 10;
                    if (!userInputLower.includes('empty') && !userInputLower.includes('alone')) goodPoints += 10;
                    if (userInput.length > 30) goodPoints += 10; // Effort
                    if (!userInputLower.includes('boring') && !userInputLower.includes('stupid')) goodPoints += 10;
                    
                    // Check that user input is not just gibberish - must have real words
                    const words = userInput.split(/\s+/).filter(w => w.length > 2);
                    const hasRealContent = words.length >= 3;
                    
                    if (hasRealContent) {
                        setScore(score + Math.min(goodPoints, challenge.points));
                        setIsCorrect(goodPoints >= 30);
                    } else {
                        setIsCorrect(false);
                    }
                } else {
                    setIsCorrect(false);
                }
                setShowFeedback(true);
            };
            
            // Helper function to calculate text similarity
            const calculateSimilarity = (str1, str2) => {
                const words1 = str1.split(/\s+/).filter(w => w.length > 2);
                const words2 = str2.split(/\s+/).filter(w => w.length > 2);
                if (words1.length === 0 || words2.length === 0) return 0;
                
                const matches = words1.filter(w => words2.some(w2 => 
                    w2.includes(w) || w.includes(w2) || w === w2
                )).length;
                return matches / Math.max(words1.length, words2.length);
            };

            const startChallenge = () => {
                setCurrentScreen('activity');
                setCurrentRound('warmup');
                setCurrentChallenge(0);
            };

            const restart = () => {
                setCurrentScreen('welcome');
                setCurrentRound('warmup');
                setCurrentChallenge(0);
                setScore(0);
                setShowFeedback(false);
                setSelectedAnswer(null);
                setSelectedItems([]);
                setUserInput('');
                setShowHint(false);
            };

            // Welcome Screen
            const WelcomeScreen = () => (
                <div className="min-h-screen bg-gradient-to-br from-indigo-600 via-purple-600 to-pink-600 flex items-center justify-center p-4 relative">
                    <div className="absolute top-4 left-4">
                        <a
                            href="./"
                            className="bg-white text-indigo-600 px-4 py-2 rounded-lg font-semibold hover:bg-gray-100 transition-all shadow-md flex items-center gap-2"
                        >
                            ‚Üê Back to Modules
                        </a>
                    </div>
                    
                    <div className="bg-white rounded-2xl shadow-2xl p-8 max-w-2xl w-full animate-fadeIn">
                        <div className="text-center">
                            <div className="text-8xl mb-4">üë£</div>
                            <h1 className="text-5xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent mb-2">
                                Digital Footprint
                            </h1>
                            <p className="text-sm font-semibold text-orange-500 tracking-wider uppercase mb-4">
                                MDID Digital Skills
                            </p>
                            <p className="text-xl text-gray-700 mb-6">
                                Every click, post, and like leaves a trail. Learn to manage your online presence!
                            </p>
                            
                            <div className="bg-gradient-to-r from-indigo-50 to-purple-50 rounded-xl p-6 mb-6 text-left">
                                <h3 className="font-bold text-indigo-800 mb-4 text-lg">üéØ Your Missions:</h3>
                                <div className="grid grid-cols-2 gap-3">
                                    {challenges.map((challenge) => (
                                        <div key={challenge.id} className="flex items-center gap-3 bg-white rounded-lg p-3 shadow-sm">
                                            <span className="text-2xl">{challenge.icon}</span>
                                            <div>
                                                <p className="font-semibold text-gray-800 text-sm">{challenge.name}</p>
                                                <p className="text-xs text-gray-600">{challenge.description}</p>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>

                            <div className="bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6 text-left rounded">
                                <p className="font-semibold text-yellow-800 mb-1">‚è±Ô∏è Time: ~15-20 minutes</p>
                                <p className="text-gray-700 text-sm">Learn what digital footprints are, how to protect yourself, and build a positive online presence!</p>
                            </div>
                            
                            <button
                                onClick={startChallenge}
                                className="bg-gradient-to-r from-indigo-500 to-purple-600 text-white px-10 py-4 rounded-xl text-xl font-bold hover:from-indigo-600 hover:to-purple-700 transform hover:scale-105 transition-all shadow-lg animate-pulse-subtle"
                            >
                                üë£ Start Your Journey!
                            </button>
                        </div>
                    </div>
                </div>
            );

            // Warm-up Screen
            const WarmupScreen = () => {
                const challenge = warmupChallenges[currentChallenge];
                
                return (
                    <div className="min-h-screen bg-gradient-to-br from-indigo-600 via-purple-600 to-pink-600 p-4 relative">
                        <div className="absolute top-4 left-4">
                            <a href="./" className="bg-white text-indigo-600 px-4 py-2 rounded-lg font-semibold hover:bg-gray-100 transition-all shadow-md flex items-center gap-2">
                                ‚Üê Back to Modules
                            </a>
                        </div>

                        <div className="max-w-3xl mx-auto pt-16">
                            <div className="text-center mb-6">
                                <span className="bg-white text-indigo-600 px-4 py-1 rounded-full text-sm font-bold">
                                    Warm-up: Understanding Digital Footprints üë£
                                </span>
                                <p className="text-white mt-2">Challenge {currentChallenge + 1} of {warmupChallenges.length}</p>
                                <p className="text-indigo-200 text-sm">Score: {score} points</p>
                            </div>

                            <div className="bg-white rounded-2xl shadow-xl p-6 animate-fadeIn">
                                <h2 className="text-2xl font-bold text-gray-800 mb-4">{challenge.title}</h2>
                                <p className="text-gray-700 mb-6">{challenge.question}</p>

                                <div className="space-y-3 mb-6">
                                    {challenge.options.map((option) => (
                                        <button
                                            key={option.id}
                                            onClick={() => challenge.type === 'multiselect' 
                                                ? handleMultiSelect(option.id) 
                                                : setSelectedAnswer(option.id)}
                                            disabled={showFeedback}
                                            className={`w-full p-4 rounded-xl text-left transition-all border-2 ${
                                                challenge.type === 'multiselect'
                                                    ? selectedItems.includes(option.id)
                                                        ? 'border-indigo-500 bg-indigo-50'
                                                        : 'border-gray-200 hover:border-indigo-300'
                                                    : selectedAnswer === option.id
                                                        ? 'border-indigo-500 bg-indigo-50'
                                                        : 'border-gray-200 hover:border-indigo-300'
                                            } ${showFeedback ? 'cursor-default' : ''}`}
                                        >
                                            <span className="font-semibold mr-2">{option.id.toUpperCase()}.</span>
                                            {option.text}
                                        </button>
                                    ))}
                                </div>

                                {!showFeedback && (
                                    <div className="flex gap-3">
                                        <button
                                            onClick={() => setShowHint(!showHint)}
                                            className="flex items-center gap-2 text-indigo-600 hover:text-indigo-700"
                                        >
                                            <Lightbulb className="w-5 h-5" />
                                            {showHint ? 'Hide Hint' : 'Need a hint?'}
                                        </button>
                                        <button
                                            onClick={checkWarmupAnswer}
                                            disabled={(challenge.type === 'multiselect' && selectedItems.length === 0) || 
                                                      (challenge.type === 'single' && !selectedAnswer)}
                                            className={`ml-auto px-6 py-3 rounded-xl font-bold transition-all ${
                                                (challenge.type === 'multiselect' && selectedItems.length > 0) ||
                                                (challenge.type === 'single' && selectedAnswer)
                                                    ? 'bg-indigo-600 text-white hover:bg-indigo-700'
                                                    : 'bg-gray-300 text-gray-500 cursor-not-allowed'
                                            }`}
                                        >
                                            Check Answer
                                        </button>
                                    </div>
                                )}

                                {showHint && !showFeedback && (
                                    <div className="mt-4 bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded animate-slideIn">
                                        <p className="text-yellow-800">üí° {challenge.hint}</p>
                                    </div>
                                )}

                                {showFeedback && (
                                    <div className={`mt-6 p-6 rounded-xl ${isCorrect ? 'bg-green-50 border-2 border-green-200' : 'bg-orange-50 border-2 border-orange-200'} animate-fadeIn`}>
                                        <div className="flex items-start gap-3">
                                            {isCorrect ? (
                                                <CheckCircle className="w-8 h-8 text-green-600 flex-shrink-0" />
                                            ) : (
                                                <XCircle className="w-8 h-8 text-orange-600 flex-shrink-0" />
                                            )}
                                            <div>
                                                <h3 className={`font-bold text-lg ${isCorrect ? 'text-green-800' : 'text-orange-800'}`}>
                                                    {isCorrect ? 'Excellent! üéâ' : 'Good try! Here\'s the scoop:'}
                                                </h3>
                                                <p className="text-gray-700 mt-2">{challenge.explanation}</p>
                                            </div>
                                        </div>
                                        <button
                                            onClick={nextChallenge}
                                            className="mt-4 w-full bg-indigo-600 text-white py-3 rounded-xl font-bold hover:bg-indigo-700 transition-all"
                                        >
                                            Continue ‚Üí
                                        </button>
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>
                );
            };

            // Scenario Screen
            const ScenarioScreen = () => {
                const challenge = scenarioChallenges[currentChallenge];
                
                return (
                    <div className="min-h-screen bg-gradient-to-br from-indigo-600 via-purple-600 to-pink-600 p-4 relative">
                        <div className="absolute top-4 left-4">
                            <a href="./" className="bg-white text-indigo-600 px-4 py-2 rounded-lg font-semibold hover:bg-gray-100 transition-all shadow-md flex items-center gap-2">
                                ‚Üê Back to Modules
                            </a>
                        </div>

                        <div className="max-w-3xl mx-auto pt-16">
                            <div className="text-center mb-6">
                                <span className="bg-white text-purple-600 px-4 py-1 rounded-full text-sm font-bold">
                                    Round 1: Smart Decisions üéØ
                                </span>
                                <p className="text-white mt-2">Scenario {currentChallenge + 1} of {scenarioChallenges.length}</p>
                                <p className="text-purple-200 text-sm">Score: {score} points</p>
                            </div>

                            <div className="bg-white rounded-2xl shadow-xl p-6 animate-fadeIn">
                                <h2 className="text-2xl font-bold text-gray-800 mb-4">{challenge.title}</h2>
                                
                                <div className="bg-gray-100 rounded-xl p-4 mb-6">
                                    <p className="text-gray-800 italic">üì± {challenge.scenario}</p>
                                </div>
                                
                                <p className="font-semibold text-gray-700 mb-4">{challenge.question}</p>

                                <div className="space-y-3 mb-6">
                                    {challenge.options.map((option) => (
                                        <button
                                            key={option.id}
                                            onClick={() => setSelectedAnswer(option.id)}
                                            disabled={showFeedback}
                                            className={`w-full p-4 rounded-xl text-left transition-all border-2 ${
                                                selectedAnswer === option.id
                                                    ? 'border-purple-500 bg-purple-50'
                                                    : 'border-gray-200 hover:border-purple-300'
                                            } ${showFeedback ? 'cursor-default' : ''}`}
                                        >
                                            <span className="font-semibold mr-2">{option.id.toUpperCase()}.</span>
                                            {option.text}
                                        </button>
                                    ))}
                                </div>

                                {!showFeedback && (
                                    <div className="flex gap-3">
                                        <button
                                            onClick={() => setShowHint(!showHint)}
                                            className="flex items-center gap-2 text-purple-600 hover:text-purple-700"
                                        >
                                            <Lightbulb className="w-5 h-5" />
                                            {showHint ? 'Hide Hint' : 'Need a hint?'}
                                        </button>
                                        <button
                                            onClick={checkScenarioAnswer}
                                            disabled={!selectedAnswer}
                                            className={`ml-auto px-6 py-3 rounded-xl font-bold transition-all ${
                                                selectedAnswer
                                                    ? 'bg-purple-600 text-white hover:bg-purple-700'
                                                    : 'bg-gray-300 text-gray-500 cursor-not-allowed'
                                            }`}
                                        >
                                            Submit Answer
                                        </button>
                                    </div>
                                )}

                                {showHint && !showFeedback && (
                                    <div className="mt-4 bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded animate-slideIn">
                                        <p className="text-yellow-800">üí° {challenge.hint}</p>
                                    </div>
                                )}

                                {showFeedback && (
                                    <div className={`mt-6 p-6 rounded-xl ${isCorrect ? 'bg-green-50 border-2 border-green-200' : 'bg-orange-50 border-2 border-orange-200'} animate-fadeIn`}>
                                        <div className="flex items-start gap-3">
                                            {isCorrect ? (
                                                <CheckCircle className="w-8 h-8 text-green-600 flex-shrink-0" />
                                            ) : (
                                                <XCircle className="w-8 h-8 text-orange-600 flex-shrink-0" />
                                            )}
                                            <div>
                                                <h3 className={`font-bold text-lg ${isCorrect ? 'text-green-800' : 'text-orange-800'}`}>
                                                    {isCorrect ? 'Great thinking! üéâ' : 'Not quite...'}
                                                </h3>
                                                <p className="text-gray-700 mt-2">
                                                    {challenge.options.find(o => o.id === selectedAnswer)?.feedback}
                                                </p>
                                                {!isCorrect && (
                                                    <p className="text-green-700 mt-2 font-semibold">
                                                        ‚úì Better answer: {challenge.options.find(o => o.correct)?.text}
                                                    </p>
                                                )}
                                            </div>
                                        </div>
                                        <button
                                            onClick={nextChallenge}
                                            className="mt-4 w-full bg-purple-600 text-white py-3 rounded-xl font-bold hover:bg-purple-700 transition-all"
                                        >
                                            Continue ‚Üí
                                        </button>
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>
                );
            };

            // Audit Screen
            const AuditScreen = () => {
                const challenge = auditChallenges[currentChallenge];
                
                if (challenge.type === 'rating') {
                    return (
                        <div className="min-h-screen bg-gradient-to-br from-indigo-600 via-purple-600 to-pink-600 p-4 relative">
                            <div className="absolute top-4 left-4">
                                <a href="./" className="bg-white text-indigo-600 px-4 py-2 rounded-lg font-semibold hover:bg-gray-100 transition-all shadow-md flex items-center gap-2">
                                    ‚Üê Back to Modules
                                </a>
                            </div>

                            <div className="max-w-3xl mx-auto pt-16">
                                <div className="text-center mb-6">
                                    <span className="bg-white text-pink-600 px-4 py-1 rounded-full text-sm font-bold">
                                        Round 2: Footprint Audit üîç
                                    </span>
                                    <p className="text-white mt-2">Challenge {currentChallenge + 1} of {auditChallenges.length}</p>
                                    <p className="text-pink-200 text-sm">Score: {score} points</p>
                                </div>

                                <div className="bg-white rounded-2xl shadow-xl p-6 animate-fadeIn">
                                    <h2 className="text-2xl font-bold text-gray-800 mb-2">{challenge.title}</h2>
                                    <p className="text-gray-600 mb-6">{challenge.scenario}</p>

                                    <div className="space-y-4 mb-6">
                                        {challenge.posts.map((post) => {
                                            const userRating = selectedItems.find(item => item.id === post.id)?.rating;
                                            return (
                                                <div key={post.id} className="border-2 border-gray-200 rounded-xl p-4">
                                                    <p className="text-gray-800 mb-3">"{post.text}"</p>
                                                    <div className="flex gap-2">
                                                        <button
                                                            onClick={() => handleRatingSelect(post.id, 'positive')}
                                                            disabled={showFeedback}
                                                            className={`flex-1 py-2 rounded-lg font-semibold transition-all ${
                                                                userRating === 'positive'
                                                                    ? 'bg-green-500 text-white'
                                                                    : 'bg-green-100 text-green-700 hover:bg-green-200'
                                                            }`}
                                                        >
                                                            ‚úì Good to Share
                                                        </button>
                                                        <button
                                                            onClick={() => handleRatingSelect(post.id, 'negative')}
                                                            disabled={showFeedback}
                                                            className={`flex-1 py-2 rounded-lg font-semibold transition-all ${
                                                                userRating === 'negative'
                                                                    ? 'bg-red-500 text-white'
                                                                    : 'bg-red-100 text-red-700 hover:bg-red-200'
                                                            }`}
                                                        >
                                                            ‚úó Risky
                                                        </button>
                                                    </div>
                                                    {showFeedback && (
                                                        <p className={`mt-2 text-sm ${
                                                            userRating === post.rating ? 'text-green-600' : 'text-orange-600'
                                                        }`}>
                                                            {post.feedback}
                                                        </p>
                                                    )}
                                                </div>
                                            );
                                        })}
                                    </div>

                                    {!showFeedback && (
                                        <button
                                            onClick={checkAuditAnswer}
                                            disabled={selectedItems.length < challenge.posts.length}
                                            className={`w-full py-3 rounded-xl font-bold transition-all ${
                                                selectedItems.length === challenge.posts.length
                                                    ? 'bg-pink-600 text-white hover:bg-pink-700'
                                                    : 'bg-gray-300 text-gray-500 cursor-not-allowed'
                                            }`}
                                        >
                                            Check All Ratings
                                        </button>
                                    )}

                                    {showFeedback && (
                                        <button
                                            onClick={nextChallenge}
                                            className="w-full bg-pink-600 text-white py-3 rounded-xl font-bold hover:bg-pink-700 transition-all"
                                        >
                                            Continue ‚Üí
                                        </button>
                                    )}
                                </div>
                            </div>
                        </div>
                    );
                }

                // Profile audit (multiselect)
                return (
                    <div className="min-h-screen bg-gradient-to-br from-indigo-600 via-purple-600 to-pink-600 p-4 relative">
                        <div className="absolute top-4 left-4">
                            <a href="./" className="bg-white text-indigo-600 px-4 py-2 rounded-lg font-semibold hover:bg-gray-100 transition-all shadow-md flex items-center gap-2">
                                ‚Üê Back to Modules
                            </a>
                        </div>

                        <div className="max-w-3xl mx-auto pt-16">
                            <div className="text-center mb-6">
                                <span className="bg-white text-pink-600 px-4 py-1 rounded-full text-sm font-bold">
                                    Round 2: Footprint Audit üîç
                                </span>
                                <p className="text-white mt-2">Challenge {currentChallenge + 1} of {auditChallenges.length}</p>
                                <p className="text-pink-200 text-sm">Score: {score} points</p>
                            </div>

                            <div className="bg-white rounded-2xl shadow-xl p-6 animate-fadeIn">
                                <h2 className="text-2xl font-bold text-gray-800 mb-2">{challenge.title}</h2>
                                <p className="text-gray-600 mb-4">{challenge.scenario}</p>

                                {/* Fake Social Profile */}
                                <div className="bg-gray-100 rounded-xl p-4 mb-6 border-2 border-gray-300">
                                    <div className="flex items-center gap-3 mb-3">
                                        <div className="w-12 h-12 bg-gradient-to-br from-pink-400 to-purple-500 rounded-full flex items-center justify-center text-white font-bold">J</div>
                                        <div>
                                            <p className="font-bold text-gray-800">{challenge.profile.username}</p>
                                            <p className="text-sm text-gray-600">{challenge.profile.bio}</p>
                                        </div>
                                    </div>
                                    <div className="space-y-2">
                                        {challenge.profile.posts.map((post, i) => (
                                            <div key={i} className="bg-white rounded-lg p-3 text-sm text-gray-700">
                                                {post}
                                            </div>
                                        ))}
                                    </div>
                                </div>

                                <p className="font-semibold text-gray-700 mb-3">Select ALL the risky information:</p>

                                <div className="grid grid-cols-2 gap-2 mb-6">
                                    {challenge.options.map((option) => (
                                        <button
                                            key={option.id}
                                            onClick={() => handleMultiSelect(option.id)}
                                            disabled={showFeedback}
                                            className={`p-3 rounded-lg text-left text-sm transition-all border-2 ${
                                                selectedItems.includes(option.id)
                                                    ? 'border-red-500 bg-red-50 text-red-800'
                                                    : 'border-gray-200 hover:border-pink-300'
                                            }`}
                                        >
                                            {selectedItems.includes(option.id) && '‚ö†Ô∏è '}{option.text}
                                        </button>
                                    ))}
                                </div>

                                {!showFeedback && (
                                    <div className="flex gap-3">
                                        <button
                                            onClick={() => setShowHint(!showHint)}
                                            className="flex items-center gap-2 text-pink-600 hover:text-pink-700"
                                        >
                                            <Lightbulb className="w-5 h-5" />
                                            {showHint ? 'Hide Hint' : 'Need a hint?'}
                                        </button>
                                        <button
                                            onClick={checkAuditAnswer}
                                            disabled={selectedItems.length === 0}
                                            className={`ml-auto px-6 py-3 rounded-xl font-bold transition-all ${
                                                selectedItems.length > 0
                                                    ? 'bg-pink-600 text-white hover:bg-pink-700'
                                                    : 'bg-gray-300 text-gray-500 cursor-not-allowed'
                                            }`}
                                        >
                                            Check Selection
                                        </button>
                                    </div>
                                )}

                                {showHint && !showFeedback && (
                                    <div className="mt-4 bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded animate-slideIn">
                                        <p className="text-yellow-800">üí° {challenge.hint}</p>
                                    </div>
                                )}

                                {showFeedback && (
                                    <div className={`mt-6 p-6 rounded-xl ${isCorrect ? 'bg-green-50 border-2 border-green-200' : 'bg-orange-50 border-2 border-orange-200'} animate-fadeIn`}>
                                        <div className="flex items-start gap-3">
                                            {isCorrect ? (
                                                <CheckCircle className="w-8 h-8 text-green-600 flex-shrink-0" />
                                            ) : (
                                                <AlertTriangle className="w-8 h-8 text-orange-600 flex-shrink-0" />
                                            )}
                                            <div>
                                                <h3 className={`font-bold text-lg ${isCorrect ? 'text-green-800' : 'text-orange-800'}`}>
                                                    {isCorrect ? 'Sharp eye! üéâ' : 'Here\'s what to look for:'}
                                                </h3>
                                                <p className="text-gray-700 mt-2">{challenge.explanation}</p>
                                            </div>
                                        </div>
                                        <button
                                            onClick={nextChallenge}
                                            className="mt-4 w-full bg-pink-600 text-white py-3 rounded-xl font-bold hover:bg-pink-700 transition-all"
                                        >
                                            Continue ‚Üí
                                        </button>
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>
                );
            };

            // Build Screen
            const BuildScreen = () => {
                const challenge = buildChallenges[currentChallenge];
                
                return (
                    <div className="min-h-screen bg-gradient-to-br from-indigo-600 via-purple-600 to-pink-600 p-4 relative">
                        <div className="absolute top-4 left-4">
                            <a href="./" className="bg-white text-indigo-600 px-4 py-2 rounded-lg font-semibold hover:bg-gray-100 transition-all shadow-md flex items-center gap-2">
                                ‚Üê Back to Modules
                            </a>
                        </div>

                        <div className="max-w-3xl mx-auto pt-16">
                            <div className="text-center mb-6">
                                <span className="bg-yellow-400 text-yellow-900 px-4 py-1 rounded-full text-sm font-bold">
                                    Final Round: Build Your Best ‚≠ê
                                </span>
                                <p className="text-white mt-2">Challenge {currentChallenge + 1} of {buildChallenges.length}</p>
                                <p className="text-yellow-200 text-sm">Score: {score} points</p>
                            </div>

                            <div className="bg-white rounded-2xl shadow-xl p-6 animate-fadeIn">
                                <h2 className="text-2xl font-bold text-gray-800 mb-2">{challenge.title}</h2>
                                <p className="text-gray-600 mb-4">{challenge.scenario}</p>

                                {/* Original risky content */}
                                <div className="bg-red-50 border-2 border-red-200 rounded-xl p-4 mb-4">
                                    <p className="text-sm font-semibold text-red-600 mb-2">‚ùå Risky Original:</p>
                                    <p className="text-gray-800 font-mono text-sm">{challenge.originalBio || challenge.originalPost}</p>
                                </div>

                                {/* Tips */}
                                <div className="bg-blue-50 rounded-xl p-4 mb-4">
                                    <p className="text-sm font-semibold text-blue-600 mb-2">‚ú® Make it better by:</p>
                                    <ul className="text-sm text-gray-700 space-y-1">
                                        {challenge.goodElements.map((elem, i) => (
                                            <li key={i}>‚Ä¢ {elem}</li>
                                        ))}
                                    </ul>
                                </div>

                                {/* User input */}
                                <div className="mb-4">
                                    <label className="block text-sm font-semibold text-gray-700 mb-2">
                                        ‚úçÔ∏è Your improved version:
                                    </label>
                                    <textarea
                                        ref={inputRef}
                                        value={userInput}
                                        onChange={(e) => setUserInput(e.target.value)}
                                        disabled={showFeedback}
                                        placeholder="Write your safer, better version here..."
                                        className="w-full p-4 border-2 border-gray-300 rounded-xl h-24 focus:border-indigo-500 focus:outline-none resize-none"
                                    />
                                    <p className="text-sm text-gray-500 mt-1">{userInput.length} characters</p>
                                </div>

                                {!showFeedback && (
                                    <div className="flex gap-3">
                                        <button
                                            onClick={() => setShowHint(!showHint)}
                                            className="flex items-center gap-2 text-indigo-600 hover:text-indigo-700"
                                        >
                                            <Lightbulb className="w-5 h-5" />
                                            {showHint ? 'Hide Example' : 'See an example'}
                                        </button>
                                        <button
                                            onClick={submitBuildChallenge}
                                            disabled={userInput.length < 10}
                                            className={`ml-auto px-6 py-3 rounded-xl font-bold transition-all ${
                                                userInput.length >= 10
                                                    ? 'bg-indigo-600 text-white hover:bg-indigo-700'
                                                    : 'bg-gray-300 text-gray-500 cursor-not-allowed'
                                            }`}
                                        >
                                            Submit
                                        </button>
                                    </div>
                                )}

                                {showHint && !showFeedback && (
                                    <div className="mt-4 bg-green-50 border-l-4 border-green-400 p-4 rounded animate-slideIn">
                                        <p className="text-sm font-semibold text-green-600 mb-1">üí° Example good version:</p>
                                        <p className="text-green-800">"{challenge.exampleRewrite}"</p>
                                    </div>
                                )}

                                {showFeedback && (
                                    <div className={`mt-6 p-6 rounded-xl ${isCorrect ? 'bg-green-50 border-2 border-green-200' : 'bg-orange-50 border-2 border-orange-200'} animate-fadeIn`}>
                                        <div className="flex items-start gap-3">
                                            {isCorrect ? (
                                                <CheckCircle className="w-8 h-8 text-green-600 flex-shrink-0" />
                                            ) : (
                                                <AlertTriangle className="w-8 h-8 text-orange-600 flex-shrink-0" />
                                            )}
                                            <div>
                                                <h3 className={`font-bold text-lg ${isCorrect ? 'text-green-800' : 'text-orange-800'}`}>
                                                    {isCorrect ? 'Great job! üéâ' : 
                                                     userInput.toLowerCase().includes(challenge.exampleRewrite.toLowerCase().slice(0, 20)) ? 
                                                     'Try writing your own version!' : 'Nice try! Here\'s an example:'}
                                                </h3>
                                                <p className="text-gray-700 mt-2">
                                                    {userInput.toLowerCase().includes(challenge.exampleRewrite.toLowerCase().slice(0, 20)) ? 
                                                     'Copying the example doesn\'t help you learn. Try creating your own unique version!' :
                                                     `A good version: "${challenge.exampleRewrite}"`}
                                                </p>
                                            </div>
                                        </div>
                                        <button
                                            onClick={nextChallenge}
                                            className="mt-4 w-full bg-indigo-600 text-white py-3 rounded-xl font-bold hover:bg-indigo-700 transition-all"
                                        >
                                            {currentChallenge < buildChallenges.length - 1 ? 'Continue ‚Üí' : 'See Results! üéâ'}
                                        </button>
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>
                );
            };

            // Completion Screen
            const CompletionScreen = () => {
                const maxScore = 320; // 60 warmup + 100 scenarios + 100 audit + 100 build
                const percentage = Math.round((score / maxScore) * 100);
                
                let badge = { emoji: "üå±", title: "Footprint Beginner", message: "You're starting to understand digital footprints!" };
                if (percentage >= 80) {
                    badge = { emoji: "‚≠ê", title: "Digital Footprint Master", message: "You truly understand how to manage your online presence!" };
                } else if (percentage >= 60) {
                    badge = { emoji: "üõ°Ô∏è", title: "Privacy Protector", message: "Great job protecting yourself online!" };
                } else if (percentage >= 40) {
                    badge = { emoji: "üë£", title: "Footprint Tracker", message: "You're learning to be aware of your digital trail!" };
                }

                return (
                    <div className="min-h-screen bg-gradient-to-br from-indigo-600 via-purple-600 to-pink-600 flex items-center justify-center p-4 relative">
                        <div className="absolute top-4 left-4">
                            <a href="./" className="bg-white text-indigo-600 px-4 py-2 rounded-lg font-semibold hover:bg-gray-100 transition-all shadow-md flex items-center gap-2">
                                ‚Üê Back to Modules
                            </a>
                        </div>

                        <div className="bg-white rounded-2xl shadow-2xl p-8 max-w-2xl w-full animate-fadeIn text-center">
                            <div className="text-8xl mb-4">{badge.emoji}</div>
                            <h1 className="text-4xl font-bold text-gray-800 mb-2">Challenge Complete!</h1>
                            <p className="text-xl text-gray-600 mb-6">{badge.title}</p>
                            
                            <div className="bg-gradient-to-r from-indigo-100 to-purple-100 rounded-xl p-6 mb-6">
                                <p className="text-5xl font-bold text-indigo-600 mb-2">{score}</p>
                                <p className="text-gray-600">points earned ({percentage}%)</p>
                                <div className="w-full bg-gray-200 rounded-full h-4 mt-4">
                                    <div 
                                        className="bg-gradient-to-r from-indigo-500 to-purple-500 h-4 rounded-full transition-all duration-1000"
                                        style={{ width: `${percentage}%` }}
                                    ></div>
                                </div>
                            </div>

                            <p className="text-gray-700 mb-6">{badge.message}</p>

                            <div className="bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6 text-left rounded">
                                <p className="font-semibold text-yellow-800 mb-2">üîë Key Takeaways:</p>
                                <ul className="text-gray-700 text-sm space-y-1">
                                    <li>‚Ä¢ Everything you do online leaves a trace</li>
                                    <li>‚Ä¢ Think before you post - would you want everyone to see this forever?</li>
                                    <li>‚Ä¢ Don't share personal details like addresses, schedules, or when you're away</li>
                                    <li>‚Ä¢ Your digital footprint affects college admissions and future jobs</li>
                                    <li>‚Ä¢ You can build a positive presence that opens doors!</li>
                                </ul>
                            </div>

                            <div className="flex gap-4">
                                <button
                                    onClick={restart}
                                    className="flex-1 bg-gradient-to-r from-indigo-500 to-purple-600 text-white py-3 rounded-xl font-bold hover:from-indigo-600 hover:to-purple-700 transition-all flex items-center justify-center gap-2"
                                >
                                    <RefreshCw className="w-5 h-5" />
                                    Try Again
                                </button>
                                <a
                                    href="./"
                                    className="flex-1 bg-gray-100 text-gray-700 py-3 rounded-xl font-bold hover:bg-gray-200 transition-all flex items-center justify-center gap-2"
                                >
                                    More Modules ‚Üí
                                </a>
                            </div>
                        </div>
                    </div>
                );
            };

            // Main render logic
            if (currentScreen === 'welcome') {
                return <WelcomeScreen />;
            } else if (currentScreen === 'completion') {
                return <CompletionScreen />;
            } else if (currentRound === 'warmup') {
                return <WarmupScreen />;
            } else if (currentRound === 'scenarios') {
                return <ScenarioScreen />;
            } else if (currentRound === 'audit') {
                return <AuditScreen />;
            } else if (currentRound === 'build') {
                return <BuildScreen />;
            }

            return <WelcomeScreen />;
        };

        // Error Boundary
        class ErrorBoundary extends React.Component {
            constructor(props) {
                super(props);
                this.state = { hasError: false, error: null };
            }

            static getDerivedStateFromError(error) {
                return { hasError: true, error };
            }

            componentDidCatch(error, errorInfo) {
                console.error("Module error:", error, errorInfo);
            }

            render() {
                if (this.state.hasError) {
                    return (
                        <div className="min-h-screen bg-gradient-to-br from-indigo-600 via-purple-600 to-pink-600 flex items-center justify-center p-4">
                            <div className="bg-white rounded-2xl shadow-xl p-8 max-w-md text-center">
                                <div className="text-6xl mb-4">üòï</div>
                                <h2 className="text-2xl font-bold text-gray-800 mb-2">Oops! Something went wrong.</h2>
                                <p className="text-gray-600 mb-4">Please refresh the page.</p>
                                <p className="text-sm text-gray-500">Error: {this.state.error?.message}</p>
                            </div>
                        </div>
                    );
                }
                return this.props.children;
            }
        }

        // Render
        try {
            console.log("Mounting React app...");
            ReactDOM.render(
                <ErrorBoundary>
                    <DigitalFootprintModule />
                </ErrorBoundary>,
                document.getElementById('root')
            );
            console.log("React app mounted successfully!");
        } catch (error) {
            console.error("Failed to mount React app:", error);
            document.getElementById('root').innerHTML = `
                <div style="padding: 20px; text-align: center;">
                    <h2 style="color: red;">Module Failed to Load</h2>
                    <p>Please check the browser console for errors.</p>
                    <p style="font-size: 12px; color: #666;">${error.message}</p>
                </div>
            `;
        }
    </script>
</body>
</html>
